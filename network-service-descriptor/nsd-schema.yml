---
  $schema: "http://json-schema.org/draft-04/schema#"
  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive"
  description: "The core scheme for RECUSRIVE service descriptors (many details left out)"
  type: "object"
  properties:
    id: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/id"
      type: "string"
    name: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/name"
      type: "string"
    vendor: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vendor"
      type: "string"
    version: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/version"
      type: "string"
    manifest_file_md5: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/manifest_file_md5"
      type: "string"
    vnfds: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vnfds"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
    nsds:
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/nsds"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
      # how do I write down that there must be at least one of VNFDs or NSDs?
    fgd:
      # the forwarding graph is more generic, it can be services or functions
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/id"
      type: "object"
      properties:
        vendor: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/vendor"
          type: "string"
        version: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/version"
          type: "string"
        ns_version: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/ns_version"
          type: "string"
        manifest_file_md5: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/manifest_file_md5"
          type: "string"
        vnffgs: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/vnffgs"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/vnffgs/0"
            type: "object"
            properties: 
              fg_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/fg_id"
                type: "string"
              number_of_endpoints: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/number_of_endpoints"
                type: "integer"
              number_of_virtual_links: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/number_of_virtual_links"
                type: "integer"
              depedent_virtual_links: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/depedent_virtual_links"
                type: "array"
                items: 
                  - 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/depedent_virtual_links/0"
                    type: "string"
                  - 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/depedent_virtual_links/1"
                    type: "string"
                  - 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/vnffgs/0/depedent_virtual_links/2"
                    type: "string"
              network_forwarding_path: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path"
                type: "array"
                items: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0"
                  type: "object"
                  properties: 
                    nfp_id: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/nfp_id"
                      type: "string"
                    graph: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/graph"
                      type: "array"
                      items: 
                        - 
                          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/graph/0"
                          type: "string"
                        - 
                          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/graph/1"
                          type: "string"
                    connection_points: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/connection_points"
                      type: "array"
                      items: 
                        - 
                          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/connection_points/0"
                          type: "string"
                        - 
                          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/vnffgs/0/network_forwarding_path/0/connection_points/1"
                          type: "string"
                    constituent_vnfs: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/constituent_vnfs"
                      type: "array"
                      items: 
                        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/constituent_vnfs/0"
                        type: "string"
                    constituent_services: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/constituent_services"
                      type: "array"
                      items: 
                        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/fgd/fgs/0/network_forwarding_path/0/constituent_services/0"
                        type: "string"
    lifecycle_events: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events"
      type: "object"
      properties: 
        start: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0/vnf_event"
                type: "string"
        stop: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0/vnf_event"
                type: "string"
        scale_out: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0/vnf_event"
                type: "string"
    vnf_depedency: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vnf_depedency"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
    services_depedency: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/services_depedency"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
    monitoring_parameters: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters"
      type: "array"
      items: 
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0"
          type: "object"
          properties: 
            desc: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/desc"
              type: "string"
            metric: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/metric"
              type: "string"
            unit: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/unit"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1"
          type: "object"
          properties: 
            desc: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/desc"
              type: "string"
            metric: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/metric"
              type: "string"
            unit: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/unit"
              type: "string"
    vld: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld"
      type: "object"
      properties: 
        id: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/id"
          type: "string"
        vendor: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vendor"
          type: "string"
        descriptor_version: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/descriptor_version"
          type: "string"
        manifest_file_md5: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/manifest_file_md5"
          type: "string"
        number_of_endpoints: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/number_of_endpoints"
          type: "integer"
        virtual_links: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links"
          type: "array"
          items: 
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0"
              type: "object"
              properties: 
                vld_id: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/vld_id"
                  type: "string"
                root_requirements: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/root_requirements"
                  type: "string"
                leaf_requirements: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/leaf_requirements"
                  type: "string"
                qos: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/qos"
                  type: "object"
                  properties: 
                    none: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/qos/none"
                      type: "string"
                test_access: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/test_access"
                  type: "string"
                connections: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections"
                  type: "array"
                  items: 
                    - 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections/0"
                      type: "string"
                    - 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections/1"
                      type: "string"
                connectivity_type: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connectivity_type"
                  type: "string"
    sla: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla"
      type: "array"
      items: 
        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0"
        type: "object"
        properties: 
          id: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/id"
            type: "string"
          flavor_key: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/flavor_key"
            type: "string"
          assurance_parameters: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters"
            type: "array"
            items: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0"
              type: "object"
              properties: 
                formula: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/formula"
                  type: "string"
                id: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/id"
                  type: "string"
                name: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/name"
                  type: "string"
                penalty: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/penalty"
                  type: "object"
                  properties: 
                    type: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/penalty/type"
                      type: "string"
                    unit: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/penalty/unit"
                      type: "string"
                    validity: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/penalty/validity"
                      type: "string"
                    value: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/penalty/value"
                      type: "integer"
                unit: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/unit"
                  type: "string"
                value: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/value"
                  type: "string"
                violations: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/violations"
                  type: "array"
                  items: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/violations/0"
                    type: "object"
                    properties: 
                      breaches_count: 
                        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/violations/0/breaches_count"
                        type: "integer"
                      interval: 
                        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/assurance_parameters/0/violations/0/interval"
                        type: "integer"
          billing: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing"
            type: "object"
            properties: 
              model: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing/model"
                type: "string"
              price: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing/price"
                type: "object"
                properties: 
                  price_per_period: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing/price/price_per_period"
                    type: "integer"
                  setup: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing/price/setup"
                    type: "integer"
                  unit: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/billing/price/unit"
                    type: "string"
          constituent_vnf: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf"
            type: "array"
            items: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf/0"
              type: "object"
              properties: 
                number_of_instances: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf/0/number_of_instances"
                  type: "integer"
                redundancy_model: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf/0/redundancy_model"
                  type: "string"
                vnf_flavour_id_reference: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf/0/vnf_flavour_id_reference"
                  type: "string"
                vnf_reference: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_vnf/0/vnf_reference"
                  type: "integer"
          constituent_services: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service"
            type: "array"
            items: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service/0"
              type: "object"
              properties: 
                number_of_instances: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service/0/number_of_instances"
                  type: "integer"
                redundancy_model: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service/0/redundancy_model"
                  type: "string"
                service_flavour_id_reference: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service/0/service_flavour_id_reference"
                  type: "string"
                service_reference: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/sla/0/constituent_service/0/service_reference"
                  type: "integer"
    auto_scale_policy: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy"
      type: "object"
      properties: 
        criteria: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria"
          type: "array"
          items: 
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/0"
              type: "object"
              properties: 
                end-to-end bandwidth: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/0/end-to-end_bandwidth"
                  type: "string"
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/1"
              type: "object"
              properties: 
                test: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/1/test"
                  type: "string"
        action: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/action"
          type: "string"
    connection_points: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points"
      type: "array"
      items: 
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0/type"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1/type"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2/type"
              type: "string"
  required: 
    - "id"
    - "name"
    - "vendor"
    - "version"
    - "vnfds"
    - "vnffgd"
    - "lifecycle_events"
    - "vnf_depedency"
    - "monitoring_parameters"
    - "vld"
    - "sla"
    - "auto_scale_policy"
    - "connection_points"

